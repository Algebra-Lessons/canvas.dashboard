(()=>{(()=>{let D={},$={},B=()=>location.host.replace(/^(?:www|edu|cooking|beta)\./,""),k=e=>{localStorage.setItem("hu-lts-frame-url",e),location.pathname!=="/s"?location.href="/s?cache=1335328661":document.getElementById("frame").src=e},l=e=>typeof e=="function"?(a,r)=>{if(a)if(a=e(a),r=`${r}`.toLowerCase(),r==="stealth"||r==1)k(a);else if(r==="window"||r==0)location.href=a;else return a}:a=>{if(a=`${a}`.toLowerCase(),a==="stealth"||a==1)k(e);else if(a==="window"||a==0)location.href=e;else return e},F=e=>async(a,r)=>{if(a)if(typeof e=="function"&&(a=await e(a)),r=`${r}`.toLowerCase(),r==="stealth"||r==1)k(a);else if(r==="window"||r==0)location.href=a;else return a},K="hu-lts-storage",V=()=>JSON.parse(localStorage.getItem(K))||{},T=e=>V()[e],M=Object.freeze({Startpage:"startpage.com/sp/search?query=",Google:"google.com/search?q=",Bing:"bing.com/search?q=",DuckDuckGo:"duckduckgo.com/?q=",Brave:"search.brave.com/search?q="}),N="DuckDuckGo",I=Object.freeze({Startpage:"www.bing.com/AS/Suggestions?csr=1&cvid=0&qry=",Google:"www.google.com/complete/search?client=gws-wiz&callback=_&q=",Bing:"www.bing.com/AS/Suggestions?csr=1&cvid=0&qry=",DuckDuckGo:"duckduckgo.com/ac/?q=",Brave:"search.brave.com/api/suggest?q="}),G=Object.values(I).map(e=>"https://"+e),R="\uE000",P=(e,a,r=[R])=>{for(let d=0;d<a.length;d++)e=e.replaceAll(a[d],r[d]||r[0]);return e},q=Object.freeze({Startpage:e=>q.Bing(e),Google:e=>e[0].map(([a])=>P(a,["<b>","</b>"])),Bing:e=>e.s.map(({q:a})=>P(a,["\uE000","\uE001"])),DuckDuckGo:e=>e.map(({phrase:a})=>a),Brave:e=>e[1]}),J=async(e,a,r=y=>y,d={})=>{switch(r){case p:{d.port.postMessage({type:d.searchType,request:{url:r(e+encodeURIComponent(a)),headers:new Map([["Date",d.time]])}});break}case A:{let y=await fetch(await r(e+encodeURIComponent(a))),S=y.headers.get("content-type"),w={};if(S&&S.indexOf("application/json")!==-1)w=await y.json();else try{w=await y.text();try{w=w.match(/(?<=\/\*hammerhead\|.*header-end\*\/)[^]+?(?=\/\*hammerhead\|.*end\*\/)/i)[0]}catch{}try{w=JSON.parse(w)}catch{w=JSON.parse(w.replace(/^[^[{]*|[^\]}]*$/g,""))}}catch{}H(d.prAC,q[d.searchType](w),Date.parse(d.time));break}}},z=Date.parse(new Date().toUTCString()),H=(e,a,r)=>{if(!(r<z)){z=r,e.textContent="";for(let d=0;d<a.length;d++){let y=document.createElement("li");y.tabIndex=0,y.append(...a[d].split(R).map((S,w)=>{if(w%2){let j=document.createElement("b");return j.textContent=S,j}return S})),e.appendChild(y)}}},X=(e=M[T("SearchEngine")]||M[N])=>`https://${e}%s`,x=e=>{try{return new URL(e)+""}catch{}try{let a=new URL(`http://${e}`);if(a.hostname.indexOf(".")!=-1)return a+""}catch{}return X().replace("%s",encodeURIComponent(e))},Y=e=>{try{e=location.origin+D.prefix+D.encodeUrl(x(e))}catch{e=x(e)}return e},p=e=>{try{e=location.origin+$(x(e))}catch{e=x(e)}return e},A=async e=>location.origin+await Q(x(e)),C={id:"collectsearchautocompleteresults",dict:""},Q=async e=>{let a=(o,t)=>(o%t+t)%t,r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~-",d="_rhs",y=()=>{let o="",t=r.split("");for(;t.length>0;)o+=t.splice(Math.random()*t.length,1)[0];return o};class S{constructor(t=y()){this.dictionary=t}shuffle(t){if(!t.indexOf(d))return t;let s="";for(let n=0;n<t.length;n++){let i=t[n],m=r.indexOf(i);i==="%"&&t.length-n>=3?s+=i+t[++n]+t[++n]:m==-1?s+=i:s+=this.dictionary[a(m+n,r.length)]}return d+s}unshuffle(t){if(t.indexOf(d))return t;t=t.slice(d.length);let s="";for(let n=0;n<t.length;n++){let i=t[n],m=this.dictionary.indexOf(i);i==="%"&&t.length-n>=3?s+=i+t[++n]+t[++n]:m==-1?s+=i:s+=r[a(m-n,r.length)]}return s}}let w=(o,t,s=!1)=>{let n=new XMLHttpRequest;n.open("GET",o,!0),n.send(),n.onerror=()=>{s||console.log("Cannot communicate with the server")},n.onload=()=>{n.status===200?t(n.responseText):s||console.log(`Unexpected server response to not match "200". Server says "${n.responseText}"`)}},j={newsession(o){w("/newsession",o)},sessionexists(o,t){w("/sessionexists?id="+encodeURIComponent(o),s=>{if(s==="exists")return t(!0);if(s==="not found")return t(!1);console.log("Unexpected response from server. Received "+s)})},shuffleDict(o,t){console.log("Shuffling",o),w("/api/shuffleDict?id="+encodeURIComponent(o),s=>{t(JSON.parse(s))})}},u="rammerhead_sessionids",h="rammerhead_default_sessionid",g={get(){let o=localStorage.getItem(u);if(!o)return[];try{let t=JSON.parse(o);if(!Array.isArray(t))throw"getout";return t}catch{return[]}},set(o){if(!Array.isArray(o))throw new TypeError("Must be an array.");localStorage.setItem(u,JSON.stringify(o))},getDefault(){let o=localStorage.getItem(h);if(o){let t=g.get();if(t.filter(s=>s.id===o),t.length)return t[0]}return null},setDefault(o){localStorage.setItem(h,o)}},c=o=>{let t=g.get();t.unshift({id:o,createdOn:new Date().toLocaleString()}),g.set(t)};return(o=>new Promise(t=>{for(let n=0;n<G.length;n++)if(o.indexOf(G[n])===0)return t(C.id);let s=localStorage.getItem("session-string");j.sessionexists(s,n=>{n?t(s):(console.log("Session validation failed"),j.newsession(i=>{c(i),localStorage.setItem("session-string",i),console.log(i),console.log("^ new id"),t(i)}))})}))(e).then(o=>o===C.id&&C.dict?new Promise(t=>{t(`/${o}/`+new S(C.dict).shuffle(e))}):new Promise(t=>{j.shuffleDict(o,s=>{o===C.id&&(C.dict=s),t(`/${o}/`+new S(s).shuffle(e))})}))},_=async()=>{D=self["i4NL40[I4]g1$\b4nE)(C2"],sjObject=self.$scramjetLoadController,sjObject&&($=new(sjObject()).ScramjetController({prefix:"/scram/network/"}).encodeUrl);let e=Object.freeze({ultraviolet:l(Y),scramjet:l(p),rammerhead:F(A),terraria:l(location.protocol+"//a."+B()),webleste:l(location.protocol+"//b."+B()),osu:l(location.origin+"/archive/osu"),agar:l(p("https://agar.io")),tru:l(p("https://truffled.lol/g")),prison:l(p("https://vimlark.itch.io/pick-up-prison")),speed:l(p("https://captain4lk.itch.io/what-the-road-brings")),heli:l(p("https://benjames171.itch.io/helo-storm")),youtube:l(p("https://youtube.com")),invidious:l(p("https://invidious.snopyta.org")),chatgpt:l(p("https://chat.openai.com/chat")),discord:l(p("https://discord.com/app")),geforcenow:l(p("https://play.geforcenow.com/mall")),spotify:l(p("https://open.spotify.com")),tiktok:l(p("https://www.tiktok.com")),hianime:l(p("https://www.hianime.to")),twitter:l(p("https://twitter.com")),twitch:l(p("https://www.twitch.tv")),instagram:l(p("https://www.instagram.com")),reddit:l(p("https://www.reddit.com")),wikipedia:l(p("https://www.wikiwand.com")),newgrounds:l(p("https://www.newgrounds.com"))}),a=async(u,h,g=1,c=10,...f)=>{if(c<=0)return console.log("Failed to recognize service workers.");let o=await Promise.all(u.map(n=>navigator.serviceWorker.getRegistration(n))),t=[],s=[];for(let n=0;n<o.length;n++)o[n]&&o[n].active?(g--,s.push(o[n])):t.push(u[n]);return g<=0?await h(...f,...s):(await Promise.race([navigator.serviceWorker.ready,new Promise(n=>{setTimeout(()=>{c--,n()},1e3)})]),await a(t,h,g,c,...f,...s))},r=(u,h)=>{let g=document.getElementById(u);if(!g)return;let c=g.querySelector("input[type=text]"),f=g.querySelector("#autocomplete"),o=document.querySelectorAll(`#${u}.pr-go1, #${u} .pr-go1`),t=document.querySelectorAll(`#${u}.pr-go2, #${u} .pr-go2`),s=c?m=>()=>{e[h](c.value,m)}:m=>()=>{e[h](m)},n={globalDefault:"window",ultraviolet:"stealth",scramjet:"stealth",rammerhead:"window"},i=n[h]||n.globalDefault;if(c){let m=!1,E=!1;if(c.addEventListener("keydown",async b=>{b.code==="Enter"?s(i)():b.code==="Validator Test"&&(b.target.value=await e[h](b.target.value),b.target.dispatchEvent(new Event("change")))}),f){let b={},L=!1;sjObject&&(b=new MessageChannel,a(["/scram/scramjet.sw.js"],v=>{v.active.postMessage({type:"requestAC"},[b.port2]),L=!0}),b.port1.addEventListener("message",({data:v})=>{H(f,q[v.searchType](v.responseJSON),Date.parse(v.time)),L=!0}),b.port1.start()),c.addEventListener("input",async v=>{if(m&&!E){if(!v.target.value){f.textContent="";return}let U=v.target.value;v.isTrusted&&(E=!0,setTimeout(()=>{E=!1,U!==v.target.value&&v.target.dispatchEvent(new Event("input"))},600));let O=T("SearchEngine");O in I||(O=N);let W=new Date().toUTCString();L?(L=!1,J("https://"+I[O],U,p,{searchType:O,port:b.port1,time:W})):J("https://"+I[O],U,A,{searchType:O,prAC:f,time:W})}}),c.addEventListener("focus",()=>{T("UseAC")!==!1&&(m=!0,f.classList.toggle("display-off",!1)),c.select()}),c.addEventListener("blur",v=>{m=!1,!(v.relatedTarget&&(v.relatedTarget.focus(),document.activeElement.parentNode===f))&&f.classList.toggle("display-off",!0)}),f.addEventListener("click",v=>{v.target.focus(),c.value=document.activeElement.textContent,s(i)()})}}o.forEach(m=>{m.addEventListener("click",s("window"))}),t.forEach(m=>{m.addEventListener("click",s("stealth"))})};r("pr-uv","ultraviolet"),r("pr-sj","scramjet"),r("pr-rh","rammerhead"),r("pr-yt","youtube"),r("pr-iv","invidious"),r("pr-cg","chatgpt"),r("pr-dc","discord"),r("pr-gf","geforcenow"),r("pr-sp","spotify"),r("pr-tt","tiktok"),r("pr-ha","hianime"),r("pr-tw","twitter"),r("pr-tc","twitch"),r("pr-ig","instagram"),r("pr-rt","reddit"),r("pr-wa","wikipedia"),r("pr-ng","newgrounds");let d=document.getElementById("frame"),y=()=>(d.src=localStorage.getItem("hu-lts-frame-url"),!0);d&&(D&&sjObject&&await a(["/scram/scramjet.sw.js","/uv/sw.js","/uv/sw-blacklist.js"],y,2,3)||y());let S=(u,h=0)=>{try{u()}catch{h<=5&&setTimeout(()=>{S(u,h+1)},600)}};document.getElementsByClassName("tippy-button").length>=0&&S(()=>{tippy(".tippy-button",{delay:50,animateFill:!0,placement:"bottom"})}),document.getElementsByClassName("pr-tippy").length>=0&&S(()=>{tippy(".pr-tippy",{delay:50,animateFill:!0,placement:"bottom"})});let w=document.getElementById("banner");w&&(S(()=>{AOS.init()}),fetch("/assets/json/splash.json",{mode:"same-origin"}).then(u=>{u.json().then(h=>{w.firstElementChild.innerHTML=h[Math.random()*h.length|0]})})),fetch("/assets/json/links.json",{mode:"same-origin"}).then(u=>{u.json().then(h=>{for(let g=Object.entries(h),c=0;c<g.length;c++)(document.getElementById(g[c][0])||{}).href=g[c][1]})});let j={"emu-nav":"emu-nav","emulib-nav":"emulib-nav","flash-nav":"flash-nav","h5-nav":"h5-nav","par-nav":"par-nav"};for(let[u,h]of Object.entries(j)){let g=document.getElementById(u);if(g){let c=await fetch(`/assets/json/${h}.json`,{mode:"same-origin"}).then(f=>f.json());switch(h){case"emu-nav":case"emulib-nav":case"par-nav":case"h5-nav":{let f={"emu-nav":"emu","emulib-nav":"emulib","par-nav":"par","h5-nav":"h5g"},o=f[h],t=(s,n)=>i=>{(i.target==n||i.target.tagName!="A")&&(i.preventDefault(),s())};for(let s=0;s<c.length;s++){let n=c[s],i=document.createElement("a"),m=document.createElement("img"),E=document.createElement("h3");desc=document.createElement("p"),credits=document.createElement("p"),i.href="#",m.src=`/assets/img/${o}/`+n.img,E.textContent=n.name,desc.textContent=n.description,credits.textContent=n.credits,h==="par-nav"&&n.credits==="truf"&&(desc.innerHTML+='<br>Credits: Check out the full site at <a target="_blank" href="/truffled">truffled.lol</a> // discord.gg/vVqY36mzvj'),i.appendChild(m),i.appendChild(E),i.appendChild(desc);let b=[()=>k(n.path),()=>k("/webretro?core="+n.core+"&rom="+n.rom),n.custom&&e[n.custom]?()=>e[n.custom]("stealth"):()=>{},n.custom&&e[n.custom]?()=>e[n.custom]("window"):()=>k("/archive/g/"+n.path)];i.addEventListener("click",t(b[Object.values(f).indexOf(o)],i)),g.appendChild(i)}break}case"flash-nav":for(let f=0;f<c.length;f++){let o=c[f],t=document.createElement("a");t.href="#",t.textContent=o.slice(0,-4),t.addEventListener("click",s=>{s.preventDefault(),k("/flash?swf="+o)}),g.appendChild(t)}break}}}};document.readyState==="loading"?addEventListener("DOMContentLoaded",_):_()})();})();
//# sourceMappingURL=common-1735118314.js.map
